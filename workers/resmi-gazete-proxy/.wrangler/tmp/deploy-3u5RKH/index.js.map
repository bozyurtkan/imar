{
  "version": 3,
  "sources": ["../../../index.js"],
  "sourceRoot": "D:\\Projeler\\\u0130mar\\i\u0307marmevzuat.ai---profesyonel-mevzuat-asistan\u0131 (15)\\workers\\resmi-gazete-proxy\\.wrangler\\tmp\\deploy-3u5RKH",
  "sourcesContent": ["/**\r\n * Cloudflare Worker - Resmi Gazete Proxy\r\n * Resmi Gazete sitesini sunucu taraf\u0131nda \u00E7ekip taray\u0131c\u0131ya d\u00F6nd\u00FCr\u00FCr.\r\n * CORS sorununu ortadan kald\u0131r\u0131r.\r\n */\r\n\r\nconst SCRAPER_API_KEY = '4a4589871cba08cf10bf008eca4945f8';\r\n\r\nconst CORS_HEADERS = {\r\n    'Access-Control-Allow-Origin': '*',\r\n    'Access-Control-Allow-Methods': 'GET, OPTIONS',\r\n    'Access-Control-Allow-Headers': 'Content-Type',\r\n    'Content-Type': 'application/json; charset=utf-8',\r\n};\r\n\r\nexport default {\r\n    async fetch(request, env, ctx) {\r\n        // OPTIONS preflight\r\n        if (request.method === 'OPTIONS') {\r\n            return new Response(null, { headers: CORS_HEADERS });\r\n        }\r\n\r\n        const url = new URL(request.url);\r\n        const tarih = url.searchParams.get('tarih');\r\n\r\n        if (!tarih) {\r\n            return new Response(\r\n                JSON.stringify({ error: 'tarih parametresi gerekli. \u00D6rn: ?tarih=2026-02-18' }),\r\n                { status: 400, headers: CORS_HEADERS }\r\n            );\r\n        }\r\n\r\n        // Resmi Gazete fihrist URL'si\r\n        const targetUrl = `https://www.resmigazete.gov.tr/fihrist?tarih=${tarih}`;\r\n        const proxyUrl = `https://api.scraperapi.com?api_key=${SCRAPER_API_KEY}&url=${encodeURIComponent(targetUrl)}`;\r\n\r\n        try {\r\n            const response = await fetch(proxyUrl, {\r\n                headers: { 'User-Agent': 'Mozilla/5.0 (compatible; ResmiGazeteBot/1.0)' },\r\n            });\r\n\r\n            if (!response.ok) {\r\n                return new Response(\r\n                    JSON.stringify({ error: `ScraperAPI hatas\u0131: ${response.status}` }),\r\n                    { status: 502, headers: CORS_HEADERS }\r\n                );\r\n            }\r\n\r\n            const html = await response.text();\r\n            const articles = parseFihrist(html);\r\n\r\n            return new Response(\r\n                JSON.stringify({ date: tarih, articles, total: articles.length }),\r\n                { headers: CORS_HEADERS }\r\n            );\r\n        } catch (err) {\r\n            return new Response(\r\n                JSON.stringify({ error: err.message }),\r\n                { status: 500, headers: CORS_HEADERS }\r\n            );\r\n        }\r\n    },\r\n};\r\n\r\nfunction parseFihrist(html) {\r\n    const articles = [];\r\n    // Hem \u00E7ift hem tek t\u0131rnakl\u0131 href'leri yakala, i\u00E7 HTML taglerini temizle\r\n    const regex = /<a\\s+[^>]*href=[\"']([^\"']*(?:eskiler|ilanlar)[^\"']*)[\"'][^>]*>([\\s\\S]*?)<\\/a>/gi;\r\n    let match;\r\n    let idCounter = 0;\r\n\r\n    while ((match = regex.exec(html)) !== null) {\r\n        const title = match[2]\r\n            .replace(/<[^>]+>/g, '')\r\n            .trim()\r\n            .replace(/^[\u2013\\-]+\\s*/, '')\r\n            .replace(/\\s+/g, ' ')\r\n            .trim();\r\n\r\n        if (title.length < 5) continue;\r\n\r\n        let link = match[1].trim();\r\n        if (!link.startsWith('http')) {\r\n            link = `https://www.resmigazete.gov.tr${link.startsWith('/') ? '' : '/'}${link}`;\r\n        }\r\n\r\n        if (!articles.some((a) => a.link === link)) {\r\n            articles.push({ id: idCounter++, title, link });\r\n        }\r\n    }\r\n\r\n    return articles;\r\n}\r\n"],
  "mappings": ";;;;AAMA,IAAM,kBAAkB;AAExB,IAAM,eAAe;AAAA,EACjB,+BAA+B;AAAA,EAC/B,gCAAgC;AAAA,EAChC,gCAAgC;AAAA,EAChC,gBAAgB;AACpB;AAEA,IAAO,gBAAQ;AAAA,EACX,MAAM,MAAM,SAAS,KAAK,KAAK;AAE3B,QAAI,QAAQ,WAAW,WAAW;AAC9B,aAAO,IAAI,SAAS,MAAM,EAAE,SAAS,aAAa,CAAC;AAAA,IACvD;AAEA,UAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAC/B,UAAM,QAAQ,IAAI,aAAa,IAAI,OAAO;AAE1C,QAAI,CAAC,OAAO;AACR,aAAO,IAAI;AAAA,QACP,KAAK,UAAU,EAAE,OAAO,uDAAoD,CAAC;AAAA,QAC7E,EAAE,QAAQ,KAAK,SAAS,aAAa;AAAA,MACzC;AAAA,IACJ;AAGA,UAAM,YAAY,gDAAgD,KAAK;AACvE,UAAM,WAAW,sCAAsC,eAAe,QAAQ,mBAAmB,SAAS,CAAC;AAE3G,QAAI;AACA,YAAM,WAAW,MAAM,MAAM,UAAU;AAAA,QACnC,SAAS,EAAE,cAAc,+CAA+C;AAAA,MAC5E,CAAC;AAED,UAAI,CAAC,SAAS,IAAI;AACd,eAAO,IAAI;AAAA,UACP,KAAK,UAAU,EAAE,OAAO,2BAAsB,SAAS,MAAM,GAAG,CAAC;AAAA,UACjE,EAAE,QAAQ,KAAK,SAAS,aAAa;AAAA,QACzC;AAAA,MACJ;AAEA,YAAM,OAAO,MAAM,SAAS,KAAK;AACjC,YAAM,WAAW,aAAa,IAAI;AAElC,aAAO,IAAI;AAAA,QACP,KAAK,UAAU,EAAE,MAAM,OAAO,UAAU,OAAO,SAAS,OAAO,CAAC;AAAA,QAChE,EAAE,SAAS,aAAa;AAAA,MAC5B;AAAA,IACJ,SAAS,KAAK;AACV,aAAO,IAAI;AAAA,QACP,KAAK,UAAU,EAAE,OAAO,IAAI,QAAQ,CAAC;AAAA,QACrC,EAAE,QAAQ,KAAK,SAAS,aAAa;AAAA,MACzC;AAAA,IACJ;AAAA,EACJ;AACJ;AAEA,SAAS,aAAa,MAAM;AACxB,QAAM,WAAW,CAAC;AAElB,QAAM,QAAQ;AACd,MAAI;AACJ,MAAI,YAAY;AAEhB,UAAQ,QAAQ,MAAM,KAAK,IAAI,OAAO,MAAM;AACxC,UAAM,QAAQ,MAAM,CAAC,EAChB,QAAQ,YAAY,EAAE,EACtB,KAAK,EACL,QAAQ,cAAc,EAAE,EACxB,QAAQ,QAAQ,GAAG,EACnB,KAAK;AAEV,QAAI,MAAM,SAAS,EAAG;AAEtB,QAAI,OAAO,MAAM,CAAC,EAAE,KAAK;AACzB,QAAI,CAAC,KAAK,WAAW,MAAM,GAAG;AAC1B,aAAO,iCAAiC,KAAK,WAAW,GAAG,IAAI,KAAK,GAAG,GAAG,IAAI;AAAA,IAClF;AAEA,QAAI,CAAC,SAAS,KAAK,CAAC,MAAM,EAAE,SAAS,IAAI,GAAG;AACxC,eAAS,KAAK,EAAE,IAAI,aAAa,OAAO,KAAK,CAAC;AAAA,IAClD;AAAA,EACJ;AAEA,SAAO;AACX;AA5BS;",
  "names": []
}
